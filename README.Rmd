---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# repipe

<!-- badges: start -->
<!-- badges: end -->

This is a simple add in for RStudio to change magrittr `%>%` pipes to native
pipes `|>` where possible. You can highlight a region of text, then use the
`repipe` command from the command pane (`Ctrl+Shift+P`). This is accomplished
through a single regular expression substitution. 

There are some edge cases where this doesn't work right now:
 - `x %>% foo("(.)")` will keep the magrittr pipe due to `.)` embedded in a string
 in the RHS

but for simple pipelines it should work well enough. This is mostly for my own
use but if others find it helpful and would like to tweak it that's also great.

## Installation

You can install  the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tsostarics/repipe")
```

## Example

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
mtcars %>% 
  tibble::as_tibble(rownames = "car") %>% 
  group_by(cyl) %>% 
  filter(gear > 4) %>% 
  .$car %>% 
  grepl("Ford", .) %>% 
  sum()
```

You can select the above region and run `repipe` to change *only* the pipes
that can be changed to native pipes. Pipes that are complemented by `.` in the
right hand side will remain as magrittr pipes.

```{r}
mtcars |> 
  tibble::as_tibble(rownames = "car") |> 
  group_by(cyl) |> 
  filter(gear > 4) %>% 
  .$car %>% 
  grepl("Ford", .) |> 
  sum()
```

Future improvements could include changing the remaining `%>%`s into native pipes
and reworking the `.` to utilize the new lambda syntax:

```{r}
mtcars |> 
  tibble::as_tibble(rownames = "car") |> 
  group_by(cyl) |> 
  filter(gear > 4) |>
  {\(x) x$car}() |>
  {\(x) grepl("Ford", x)}() |> 
  sum()
```

